<?php

namespace App\Controller;

use App\Data\SearchData;

use App\SpecClass\Reponse;
use App\Form\SearchFormIfe;
use App\Repository\TitgficettRepository;
use App\Repository\TitgficpstRepository;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Annotation\Route;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;

class ExploitationController extends AbstractController
{
    /**
     * @Route("/exp/sviItgett", name="exp_svi_itgett")
     */
    public function expSviItgficett(TitgficettRepository $titgficettRepository, Request $request): Response
    {
        $data = new SearchData;
        $form = $this->createForm(SearchFormIfe::class, $data);
        $form->handleRequest($request);
        $reponse = new Reponse;
        $maxResult = 1000;

        $titgficett = $titgficettRepository->findSearch($data, $maxResult, $reponse);
        $nb = count($titgficett);
        include "shared/_flashFiltre.txt";
        return $this->render('exploitation/sviItgett.html.twig', [
            'titgficett' => $titgficett,
            'form' => $form->createView(),
        ]);
    }
    /**
     * @Route("/exp/sviItgpst/{id}", name="exp_svi_itgpst")
     */
    public function expSviItgficpst($id, TitgficpstRepository $titgficpstRepository): Response
    {
        $titgficpst = $titgficpstRepository->findBy(['clrItgfic' => $id], ['num' => 'ASC']);
        return $this->render('exploitation/sviItgpst.html.twig', [
            'titgficpst' => $titgficpst,
        ]);
    }
}
